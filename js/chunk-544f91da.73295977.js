(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-544f91da"],{"0cdc":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"ActivityComplete"}},[r("Title",{attrs:{title:e.$router.currentRoute.meta.title}}),e.form.ArchiveFiles?r("div",{staticClass:"form"},[r("el-form",{ref:"form",attrs:{"label-width":"150px"}},[r("div",{staticStyle:{display:"flex"}},[r("el-form-item",{attrs:{label:"活動實際開始時間"}},[r("div",[e._v(e._s(e.YYYYMMDDhhmmss(e.form.ActStartDate)))])]),r("el-form-item",{attrs:{label:"活動實際結束時間"}},[r("div",[e._v(e._s(e.YYYYMMDDhhmmss(e.form.ActEndDate)))])])],1),e.form?r("div",{staticStyle:{"border-width":"3px 0 0 0","border-style":"solid","border-color":"#dedede",padding:"28px 0"}},[r("el-form-item",{attrs:{label:"簽到單掃描檔"}},[r("el-radio-group",{model:{value:e.form.HasSign,callback:function(t){e.$set(e.form,"HasSign",t)},expression:"form.HasSign"}},[r("el-radio",{attrs:{label:!0}},[e._v("是")]),r("el-radio",{attrs:{label:!1}},[e._v("否")])],1),r("span",{staticStyle:{padding:"0 0 0 20px"}},[e._v("若用紙本簽到，是否有掃描檔?")])],1),r("el-form-item",{attrs:{label:"徵稿啟事"}},[r("el-radio-group",{on:{change:e.importFile},model:{value:e.form.HasCallPapers,callback:function(t){e.$set(e.form,"HasCallPapers",t)},expression:"form.HasCallPapers"}},[r("el-radio",{attrs:{label:!0}},[e._v("是")]),r("el-radio",{attrs:{label:!1}},[e._v("否")])],1),r("span",{staticStyle:{padding:"0 0 0 20px"}},[e._v("若為學術研討會並公開徵稿，是否有提供徵稿啟事電子檔?")])],1),r("el-form-item",{attrs:{label:"研習活動錄影(音)著作權授權同意書"}},[r("el-radio-group",{model:{value:e.form.HasVideoAgree,callback:function(t){e.$set(e.form,"HasVideoAgree",t)},expression:"form.HasVideoAgree"}},[r("el-radio",{attrs:{label:!0}},[e._v("是")]),r("el-radio",{attrs:{label:!1}},[e._v("否")])],1),r("span",{staticStyle:{padding:"0 0 0 20px"}},[e._v("若活動現場有錄影錄音，是否有提供講者授權同意書?")])],1),r("el-form-item",{attrs:{label:"主持人"}},[r("el-radio-group",{model:{value:e.form.HasHoster,callback:function(t){e.$set(e.form,"HasHoster",t)},expression:"form.HasHoster"}},[r("el-radio",{attrs:{label:!0}},[e._v("是")]),r("el-radio",{attrs:{label:!1}},[e._v("否")])],1),r("span",{staticStyle:{padding:"0 0 0 20px"}},[e._v("主辦單位主管/計畫主持人是否有出席該活動?")])],1)],1):e._e(),r("div",{staticStyle:{"border-width":"3px 0","border-style":"solid","border-color":"#dedede",padding:"28px 0"}},[r("el-form-item",{attrs:{label:"所有附件"}},[r("el-table",{staticStyle:{width:"800px"},attrs:{data:e.form.ArchiveFiles.allFile}},[r("el-table-column",{attrs:{label:"附件名稱",prop:"response"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.path[0].response))]}}],null,!1,211866123)}),r("el-table-column",{attrs:{label:"附件類別",prop:"response"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.type))]}}],null,!1,469485541)}),r("el-table-column",{attrs:{label:"附件說明"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{domProps:{innerHTML:e._s(t.row.remark)}})]}}],null,!1,4043026422)}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"iconList"},[r("a",{attrs:{href:e.$store.state.fileBase+t.row.path[0].response,target:"_blank"}},[r("el-button",{attrs:{type:"primary"}},[e._v("下載")])],1),"W"==e.form.Status?r("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{type:"danger"},on:{click:function(r){return e.FilesRemove(t.$index)}}},[e._v("刪除")]):e._e()],1)]}}],null,!1,1810385047)})],1)],1),r("div",{staticStyle:{display:"flex"}},["W"==e.form.Status?r("el-form-item",{attrs:{label:"上傳附件"}},[r("div",{staticStyle:{display:"flex"}},[r("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.addFileForm.type,callback:function(t){e.$set(e.addFileForm,"type",t)},expression:"addFileForm.type"}},[e.form.HasSign?r("el-option",{attrs:{label:"簽到單掃描檔",value:"簽到單掃描檔"}}):e._e(),e.form.HasCallPapers?r("el-option",{attrs:{label:"徵稿啟事",value:"徵稿啟事"}}):e._e(),e.form.HasVideoAgree?r("el-option",{attrs:{label:"研習活動錄影(音)著作權授權同意書",value:"研習活動錄影(音)著作權授權同意書"}}):e._e(),e.form.HasHoster?r("el-option",{attrs:{label:"主持人參與證明",value:"主持人參與證明"}}):e._e()],1),r("el-upload",{attrs:{"show-file-list":!1,action:e.$store.state.apiBase+"Img",headers:{authorization:"Bearer "+e.$store.state.token},"on-success":function(t,r){return e.successUpdata(t,r,"path",!0,"addFileForm")}}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("點擊上傳")])],1),e._l(e.addFileForm.path,(function(t,a){return r("a",{key:a,attrs:{href:e.$store.state.fileBase+t.response,target:"_blank"}},[e._v(e._s(t.response))])}))],2)]):e._e(),"W"==e.form.Status?r("el-form-item",{attrs:{label:"附件說明"}},[r("el-input",{staticStyle:{width:"240px"},model:{value:e.addFileForm.remark,callback:function(t){e.$set(e.addFileForm,"remark",t)},expression:"addFileForm.remark"}}),e.addFileForm.path.length?r("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{type:"primary"},on:{click:e.toAddFile}},[e._v("確定送出")]):e._e()],1):e._e()],1)],1)]),r("div",[r("h2",[e._v("簽核紀錄")]),r("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"tableHeader",data:e.GetActivityFlowLogList}},[r("el-table-column",{attrs:{label:"順序"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+1))]}}],null,!1,811300409)}),r("el-table-column",{attrs:{label:"審核人",prop:"UserId"}}),r("el-table-column",{attrs:{label:"審核狀態",prop:"Status",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.$store.state.CompleteState[t.row.Status]))]}}],null,!1,1880089213)}),r("el-table-column",{attrs:{label:"備註",prop:"Remark",sortable:""}}),r("el-table-column",{attrs:{label:"簽核時間",prop:"CreateDate",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.YYYYMMDDhhmmss(t.row.CreateDate)))]}}],null,!1,498190572)})],1)],1)],1):e._e(),r("div",{staticClass:"formButtonList"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("回上一頁")]),"W"==e.form.Status?r("el-button",{attrs:{type:"primary",disabled:!e.canSub},on:{click:e.sub}},[e._v("簽核")]):e._e(),e.canSub?e._e():r("span",{staticStyle:{display:"inline-block","margin-left":"1rem",color:"red"}},[e._v("請確認對應簽核檔案是否正確上傳")]),"I"==e.form.Status?r("el-button",{attrs:{type:"primary"},on:{click:e.toEdit}},[e._v("取消簽核")]):e._e()],1)],1)},l=[],i=r("a34a"),o=r.n(i),s=r("c1df"),n=r.n(s),u=r("43b3");function c(e,t,r,a,l,i,o){try{var s=e[i](o),n=s.value}catch(u){return void r(u)}s.done?t(n):Promise.resolve(n).then(a,l)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(a,l){var i=e.apply(t,r);function o(e){c(i,a,l,o,s,"next",e)}function s(e){c(i,a,l,o,s,"throw",e)}o(void 0)}))}}var f={components:{Title:u["a"]},data:function(){return{step:1,form:{},GetActivityFlowLogList:[],addFileForm:{type:"",path:"",remark:""}}},computed:{showIcons:function(){return"W"==this.form.Status},canSub:function(){var e=!0;if(this.form.HasSign){var t=this.form.ArchiveFiles.allFile.filter((function(e){return"簽到單掃描檔"==e.type})).length;t||(e=!1)}if(this.form.HasCallPapers){var r=this.form.ArchiveFiles.allFile.filter((function(e){return"徵稿啟事"==e.type})).length;r||(e=!1)}if(this.form.HasVideoAgree){var a=this.form.ArchiveFiles.allFile.filter((function(e){return"研習活動錄影(音)著作權授權同意書"==e.type})).length;a||(e=!1)}if(this.form.HasHoster){var l=this.form.ArchiveFiles.allFile.filter((function(e){return"主持人參與證明"==e.type})).length;l||(e=!1)}return e}},created:function(){var e=this;return d(o.a.mark((function t(){var r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$router.currentRoute.query.Id){t.next=10;break}return t.next=3,e.$api.GetActivityFlowLog({actId:e.$router.currentRoute.query.Id}).then((function(e){return e.data.response}));case 3:return e.GetActivityFlowLogList=t.sent,t.next=6,e.$api.GetActivityById({Id:e.$router.currentRoute.query.Id}).then((function(e){return e.data.response}));case 6:e.form=t.sent,r=JSON.parse(e.form.ArchiveFiles).allFile,0===r.length&&"W"==e.form.Status&&(e.form.HasSign=!0,e.form.HasHoster=!0),e.form.ArchiveFiles?e.form.ArchiveFiles=JSON.parse(e.form.ArchiveFiles):e.form.ArchiveFiles={start:"",end:"",auth:"",noAuth:"",allFile:[]};case 10:case"end":return t.stop()}}),t)})))()},methods:{sub:function(){var e=this;return d(o.a.mark((function t(){var r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="",e.$store.dispatch("loadingHandler",!0),e.form.ArchiveFiles=JSON.stringify(e.form.ArchiveFiles),e.form.Status="I",t.next=6,e.$api.SetActivityById({id:e.$router.currentRoute.query.Id});case 6:return t.next=8,e.$api.PutActivity(e.form).then((function(e){return e.data.msg})).catch((function(){return"網路錯誤"}));case 8:r=t.sent,e.$router.push({path:"/Activity/List"}),e.$store.dispatch("loadingHandler",!1),e.$alertM.fire({icon:"網路錯誤"==r?"error":"success",title:r});case 12:case"end":return t.stop()}}),t)})))()},successUpdata:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"form";a&&(this[l][r]=[]),e.remark="",this[l][r].push(e),console.log(this.addFileForm.path)},FilesRemove:function(e){this.form.ArchiveFiles.allFile.splice(e,1)},YYYYMMDDhhmmss:function(e){return n()(e).format("YYYY-MM-DD HH:mm:ss")},toEdit:function(){var e=this;return d(o.a.mark((function t(){var r,a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={actId:e.$router.currentRoute.query.Id},t.next=3,e.$api.CancelFlowStatusBySelf(r).then((function(e){return e.data}));case 3:if(a=t.sent,e.$alertM.fire({icon:a.success?"success":"error",title:a.msg}),!e.$router.currentRoute.query.Id){t.next=13;break}return t.next=8,e.$api.GetActivityFlowLog({actId:e.$router.currentRoute.query.Id}).then((function(e){return e.data.response}));case 8:return e.GetActivityFlowLogList=t.sent,t.next=11,e.$api.GetActivityById({Id:e.$router.currentRoute.query.Id}).then((function(e){return e.data.response}));case 11:e.form=t.sent,e.form.ArchiveFiles?e.form.ArchiveFiles=JSON.parse(e.form.ArchiveFiles):e.form.ArchiveFiles={start:"",end:"",auth:"",noAuth:"",allFile:[]};case 13:e.showEdit=!1;case 14:case"end":return t.stop()}}),t)})))()},toAddFile:function(){console.log(this.form.ArchiveFiles),console.log(this.form.ArchiveFiles.allFile),this.form.ArchiveFiles.allFile.push(this.addFileForm),this.addFileForm={type:"簽到單掃描檔",path:"",remark:""}},importFile:function(e){if(!e)return 0;var t=JSON.parse(this.form.SolicitFile);if(t=t.filter((function(e){return e})),!t.length)return 0;this.form.ArchiveFiles.allFile.push({type:"徵稿啟事",path:[t[0]],remark:""}),console.log(this.form.ArchiveFiles.allFile)}}},m=f,p=r("2877"),h=Object(p["a"])(m,a,l,!1,null,null,null);t["default"]=h.exports},"43b3":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"title"}},[e._v(" "+e._s(e.title)+" ")])},l=[],i={props:["title"]},o=i,s=r("2877"),n=Object(s["a"])(o,a,l,!1,null,null,null);t["a"]=n.exports},a34a:function(e,t,r){e.exports=r("96cf")}}]);
//# sourceMappingURL=chunk-544f91da.73295977.js.map