{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./src/views/User/Authority.vue?9cdc","webpack:///src/views/User/Authority.vue","webpack:///./src/views/User/Authority.vue?7d21","webpack:///./src/views/User/Authority.vue"],"names":["module","exports","require","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","slot","_v","staticStyle","on","refreshRoles","_l","role","key","Id","class","roleid","$event","getPermissionByRid","Name","_s","editHandler","ref","authorityData","defaultProps","getCheckedKeys","_e","staticRenderFns","name","data","ogTree","roleName","permissionId","children","label","roles","rolesData","methods","vm","$store","dispatch","id","rid","$api","GetPermissionByRid","params","then","res","response","permissionids","$nextTick","$refs","tree","setCheckedKeys","$swal","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","value","console","log","EditPermissionByRid","$alertT","fire","$alertM","computed","data5","JSON","parse","stringify","component"],"mappings":"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","file":"js/chunk-9b2cbb2e.f80a9336.js","sourcesContent":["module.exports = require(\"regenerator-runtime\");\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"userAuthority\"}},[_c('el-col',{staticClass:\"toolbar roles\",attrs:{\"span\":12}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"authorityHeader\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"角色\")]),_c('el-button',{staticStyle:{\"padding\":\"3px 0\"},attrs:{\"type\":\"text\"},on:{\"click\":_vm.refreshRoles}},[_vm._v(\"刷新\")])],1),_vm._l((_vm.rolesData),function(role){return _c('div',{key:role.Id,staticClass:\"text item role-item\",class:role.Id == _vm.roleid ? 'active' : '',on:{\"click\":function($event){return _vm.getPermissionByRid(role.Id,role.Name)}}},[_vm._v(_vm._s(role.Name))])})],2)],1),_c('el-col',{staticClass:\"toolbar perms\",attrs:{\"span\":12}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"authorityHeader\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"權限管理\")]),_c('el-button',{staticStyle:{\"padding\":\"3px 0\"},attrs:{\"type\":\"text\"},on:{\"click\":_vm.editHandler}},[_vm._v(\"修改\")])],1),_c('div',[(_vm.authorityData)?_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.authorityData,\"show-checkbox\":\"\",\"node-key\":\"value\",\"default-expand-all\":\"\",\"expand-on-click-node\":true,\"props\":_vm.defaultProps},on:{\"check\":_vm.getCheckedKeys}}):_vm._e()],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"userAuthority\">\r\n    <el-col :span=\"12\" class=\"toolbar roles\">\r\n      <el-card class=\"box-card\">\r\n        <div slot=\"header\" class=\"authorityHeader\">\r\n          <span>角色</span>\r\n          <el-button style=\"padding: 3px 0\" type=\"text\" @click=\"refreshRoles\">刷新</el-button>\r\n        </div>\r\n        <div\r\n          v-for=\"role in rolesData\"\r\n          :key=\"role.Id\"\r\n          @click=\"getPermissionByRid(role.Id,role.Name)\"\r\n          :class=\"role.Id == roleid ? 'active' : ''\"\r\n          class=\"text item role-item\"\r\n        >{{ role.Name }}</div>\r\n      </el-card>\r\n    </el-col>\r\n\r\n    <el-col :span=\"12\" class=\"toolbar perms\">\r\n      <el-card class=\"box-card\">\r\n        <div slot=\"header\" class=\"authorityHeader\">\r\n          <span>權限管理</span>\r\n          <el-button @click=\"editHandler\" style=\"padding: 3px 0\" type=\"text\">修改</el-button>\r\n        </div>\r\n        <div>\r\n          <el-tree\r\n            v-if=\"authorityData\"\r\n            :data=\"authorityData\"\r\n            @check=\"getCheckedKeys\"\r\n            show-checkbox\r\n            node-key=\"value\"\r\n            ref=\"tree\"\r\n            default-expand-all\r\n            :expand-on-click-node=\"true\"\r\n            :props=\"defaultProps\"\r\n          ></el-tree>\r\n        </div>\r\n      </el-card>\r\n    </el-col>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import tree from ''\r\nimport ogTree from \"../../assets/tree.json\";\r\nexport default {\r\n  name: \"UserAuthority\",\r\n  data() {\r\n    return {\r\n      ogTree,\r\n      roleid: \"\",\r\n      roleName: \"\",\r\n      permissionId: [],\r\n      defaultProps: {\r\n        children: \"children\",\r\n        label: \"label\"\r\n      },\r\n      roles: [\r\n        {\r\n          Name: \"Super_Admin\",\r\n          Id: 1\r\n        },\r\n        {\r\n          Name: \"Admin\",\r\n          Id: 2\r\n        },\r\n        {\r\n          Name: \"Master\",\r\n          Id: 3\r\n        },\r\n        {\r\n          Name: \"User\",\r\n          Id: 4\r\n        }\r\n      ],\r\n      rolesData: \"\",\r\n      authorityData: \"\"\r\n    };\r\n  },\r\n  methods: {\r\n    async getAuthority() {\r\n      const vm = this;\r\n      let params = {\r\n        needbtn: true\r\n      };\r\n      await vm.$api.GetAuthority(params).then(res => {\r\n        vm.authorityData = res.data.response.children;\r\n        console.log(vm.authorityData);\r\n      });\r\n    },\r\n    async getRoles() {\r\n      const vm = this;\r\n      await vm.$api.GetAllRoles().then(res => {\r\n        vm.rolesData = res.data.response;\r\n      });\r\n    },\r\n    async refreshRoles() {\r\n      const vm = this;\r\n      vm.$store.dispatch(\"loadingHandler\", true);\r\n      await vm.getRoles();\r\n\r\n      vm.$store.dispatch(\"loadingHandler\", false);\r\n      vm.$alertM.fire({\r\n        icon: \"success\",\r\n        title: `角色列表刷新成功 ! `\r\n      });\r\n    },\r\n    getPermissionByRid(id, name) {\r\n      const vm = this;\r\n      vm.$store.dispatch(\"loadingHandler\", true);\r\n      vm.roleid = id;\r\n      vm.roleName = name;\r\n      let rid = id;\r\n      let params = {\r\n        rid\r\n      };\r\n      vm.$api.GetPermissionByRid(params).then(res => {\r\n        // console.log(res.data.response.permissionids);\r\n        vm.permissionId = res.data.response.permissionids;\r\n        vm.$nextTick(function() {\r\n          this.$refs.tree.setCheckedKeys(vm.permissionId);\r\n        });\r\n        vm.$store.dispatch(\"loadingHandler\", false);\r\n      });\r\n    },\r\n    editHandler() {\r\n      const vm = this;\r\n      if (!vm.roleName) {\r\n        vm.$alertM.fire({\r\n          icon: \"error\",\r\n          title: \"請選擇欲修改角色 ! \"\r\n        });\r\n      } else {\r\n        vm.$swal({\r\n          title: \"修改提示\",\r\n          text: `確認修改角色 ${vm.roleName} 權限 ?`,\r\n          icon: \"warning\",\r\n          showCancelButton: true,\r\n          confirmButtonColor: \"#2f3e52\",\r\n          cancelButtonColor: \"#522f2f\",\r\n          confirmButtonText: \"確定\",\r\n          cancelButtonText: \"取消\"\r\n        }).then(result => {\r\n          if (result.value) {\r\n            vm.$store.dispatch(\"loadingHandler\", true);\r\n            let rid = vm.roleid;\r\n            let pids = vm.$refs.tree.getCheckedKeys();\r\n            let params = { rid, pids };\r\n            console.log(params);\r\n            vm.$api.EditPermissionByRid(params).then(res => {\r\n              vm.$alertT.fire({\r\n                icon: \"success\",\r\n                title: `角色 ${vm.roleName} 權限修改成功 ! `\r\n              });\r\n              vm.$store.dispatch(\"loadingHandler\", false);\r\n            });\r\n          } else {\r\n            vm.$alertT.fire({\r\n              icon: \"warning\",\r\n              title: `已取消修改`\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    getCheckedKeys() {\r\n      console.log(this.$refs.tree.getCheckedKeys());\r\n    }\r\n  },\r\n  computed: {\r\n    data5() {\r\n      let data = this.ogTree.response.children;\r\n      return JSON.parse(JSON.stringify(data));\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.$store.dispatch(\"loadingHandler\", true);\r\n    this.getRoles();\r\n    await this.getAuthority();\r\n\r\n    this.$store.dispatch(\"loadingHandler\", false);\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Authority.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Authority.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Authority.vue?vue&type=template&id=241cd010&\"\nimport script from \"./Authority.vue?vue&type=script&lang=js&\"\nexport * from \"./Authority.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}