(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24938be4"],{1799:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"pagination"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"pager-count":5,"current-page":e.setCurrentPage,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}})],1)},r=[],s=(a("c1df"),a("4360")),i={name:"Pagination",data:function(){return{}},props:{total:{type:Number,default:1,required:!0},keyWord:{type:String,default:"",required:!1},start:{type:String,default:"",required:!1},end:{type:String,default:"",required:!1},currentPage:{type:Number,default:1,required:!1},pageSize:{type:Number,default:10,required:!1}},computed:{setCurrentPage:{get:function(){return this.$props.currentPage},set:function(){}}},methods:{handleCurrentChange:function(e){if(s["a"].dispatch("loadingHandler",!0),this.setCurrentPage=e,this.$props.end){console.log("END");var t=this.$props.keyWord;console.log(t);var a=this.$props.start,n=this.$props.end;this.$emit("changePage",e,t,a,n),window.scrollTo(0,0)}else{var r=this.$props.keyWord;this.$emit("changePage",e,r),window.scrollTo(0,0)}}}},l=i,o=a("2877"),c=Object(o["a"])(l,n,r,!1,null,null,null);t["a"]=c.exports},"97d4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"headerBox"}},[a("div",{staticClass:"searchBox"},[e.showDatePicker?a("el-date-picker",{staticClass:"datePicker",attrs:{type:"daterange","range-separator":"~","start-placeholder":"開始時間","end-placeholder":"結束時間"},on:{change:e.setSearchDate},model:{value:e.searchDate,callback:function(t){e.searchDate=t},expression:"searchDate"}}):e._e(),e.hasBtn("btnSearch")&&!e.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setSearchHandler(t)}},model:{value:e.keyWordInput,callback:function(t){e.keyWordInput=t},expression:"keyWordInput"}}):e._e(),e.hasBtn("btnSearch")&&e.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setSearchHandlerDate(t)}},model:{value:e.keyWordInput,callback:function(t){e.keyWordInput=t},expression:"keyWordInput"}}):e._e(),e.hasBtn("btnSearch")&&!e.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:e.searchLoading,type:"primary"},on:{click:e.setSearchHandler}},[e._v("搜尋")]):e._e(),e.hasBtn("btnSearch")&&e.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:e.searchLoading,type:"primary"},on:{click:e.setSearchHandlerDate}},[e._v("搜尋")]):e._e(),e.hasBtn("btnAdd")?a("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(t){return e.setHandleAddOrEdit("add")}}},[e._v("新增")]):e._e(),e.hasBtn("btnEdit")&&e.isEvent?a("el-button",{staticClass:"changeBtn",attrs:{type:"primary"},on:{click:e.setChangeHandler}},[e._v("批次替換")]):e._e(),e.hasBtn("btnImport")?a("el-button",{staticClass:"importBtn",attrs:{type:"primary"},on:{click:e.setImportHandler}},[e._v("匯入")]):e._e(),e.hasBtn("btnExport")?a("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:e.setExportHandler}},[e._v("匯出")]):e._e()],1)])},r=[],s=a("c1df"),i=a.n(s),l={name:"HeaderBox",data:function(){return{keyWordInput:"",changeDialogVisible:!1,importDialogVisible:!1,searchDate:""}},props:{buttonList:{type:Array,required:!0,default:[]},showDatePicker:{type:Boolean,default:!1,required:!1},searchLoading:{type:Boolean,default:!1,required:!1},isEvent:{type:Boolean,default:!1,required:!1}},methods:{hasBtn:function(e){return this.buttonList.some((function(t){return t.iconCls==e}))},setHandleAddOrEdit:function(e){this.$emit("handleAddOrEdit",e)},setChangeHandler:function(){this.$emit("changeHandler")},setSearchDate:function(){this.$emit("getSearchDate",this.searchDate)},setSearchHandler:function(){var e=this,t=1,a=e.keyWordInput;e.$emit("searchHandler",{page:t,key:a})},setExportHandler:function(){var e=this,t=e.keyWordInput;if(null!==e.searchDate&&e.searchDate){var a=i()(e.searchDate[0]).format("YYYY-MM-DD"),n=i()(e.searchDate[1]).format("YYYY-MM-DD");e.$emit("exportHandler",{key:t,startDate:a,endDate:n})}else{var r="",s="";e.$emit("exportHandler",{key:t,startDate:r,endDate:s})}},setImportHandler:function(){this.$emit("importHandler",!0)},setSearchHandlerDate:function(){var e=this,t=1,a=e.keyWordInput;if(console.log(e.searchDate),null!==e.searchDate&&e.searchDate){console.log("y");var n=i()(e.searchDate[0]).format("YYYY-MM-DD"),r=i()(e.searchDate[1]).format("YYYY-MM-DD");e.$emit("searchHandlerDate",{page:t,key:a,startDate:n,endDate:r})}else{console.log("n");var s="",l="";e.$emit("searchHandlerDate",{page:t,key:a,startDate:s,endDate:l})}}}},o=l,c=a("2877"),u=Object(c["a"])(o,n,r,!1,null,null,null);t["a"]=u.exports},a34a:function(e,t,a){e.exports=a("96cf")},bfe3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"userUsers"}},[a("HeaderBox",{attrs:{searchLoading:e.searchLoading,buttonList:e.buttonList,isUser:!0},on:{searchHandler:e.searchHandler,handleAddOrEdit:e.handleAddOrEdit,changeHandler:e.changeHandler}}),a("div",{staticClass:"mainTable"},[a("div",{staticClass:"tableContainer mt-5"},[e.adminUsersData?a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"tableHeader",data:e.adminUsersData,"empty-text":"暫無資料","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"UnitName",width:"150",label:"單位",sortable:""}}),a("el-table-column",{attrs:{prop:"RealName",width:"100",label:"名稱",sortable:""}}),a("el-table-column",{attrs:{prop:"LoginName",width:"100",label:"帳號",sortable:""}}),a("el-table-column",{attrs:{prop:"RoleNames",label:"角色",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.RoleNames,(function(t){return a("span",{key:"da"+t,staticClass:"roleBadge"},[e._v(e._s(t))])}))}}],null,!1,303443157)}),a("el-table-column",{attrs:{prop:"DropCtrlTypes",label:"控制類別",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark","open-delay":500,placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},e._l(t.row.DropCtrlTypes,(function(t,n){return a("span",{key:"da"+t.Value},[e._v(e._s(n+1)+"."+e._s(t.Text))])})),0),a("p",{staticClass:"textOverflow"},e._l(t.row.DropCtrlTypes,(function(t,n){return a("span",{key:"da"+t.Value,staticClass:"unitBadge"},[e._v(e._s(n+1)+"."+e._s(t.Text))])})),0)])]}}],null,!1,4069916227)}),a("el-table-column",{attrs:{prop:"CtrlUnits",label:"組織",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark","open-delay":500,placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},e._l(t.row.CtrlUnits,(function(t,n){return a("span",{key:"da"+t},[e._v(e._s(n+1)+"."+e._s(t))])})),0),a("p",{staticClass:"textOverflow"},e._l(t.row.CtrlUnits,(function(t,n){return a("span",{key:"da"+t,staticClass:"unitBadge"},[e._v(e._s(n+1)+"."+e._s(t))])})),0)])]}}],null,!1,3571229539)}),a("el-table-column",{attrs:{prop:"emit","min-width":"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasBtn("btnEdit")?a("el-button",{staticClass:"outline",attrs:{size:"mini"},on:{click:function(a){return e.handleAddOrEdit("edit",t.row)}}},[e._v("編輯")]):e._e(),e.hasBtn("btnDelete")?a("el-button",{staticClass:"outline",attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteHandler(t.row)}}},[e._v("刪除")]):e._e(),e.hasBtn("btnDelete")?a("el-button",{staticClass:"outline",attrs:{size:"mini"},on:{click:function(a){return e.handleChangeUser(t.row)}}},[e._v("切換")]):e._e()]}}],null,!1,1046337868)})],1):e._e()],1)]),e.totalCount?a("Pagination",{attrs:{keyWord:e.keyWordInput,total:e.totalCount,currentPage:e.currentPage,pageSize:e.pageSize},on:{changePage:e.getUsersPage}}):e._e(),e.unitsData?a("el-dialog",{attrs:{title:e.addOrEdit,visible:e.addOrEditDialog,"custom-class":"addOrEditDialog"},on:{opened:e.scrollToTop,close:function(t){e.arrUnit=[]},"update:visible":function(t){e.addOrEditDialog=t}}},[a("ValidationObserver",{ref:"obs"},[a("el-scrollbar",{ref:"scrollBox",staticClass:"scrollbar-handle"},[a("div",{staticClass:"inputBox",staticStyle:{"margin-top":"3rem"}},[a("p",{staticClass:"inputTitle"},[e._v("單位")]),a("ValidationProvider",{attrs:{name:"請選擇最高單位",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,r=t.classes;return[a("el-select",{staticClass:"unitSelect",class:r,attrs:{filterable:"","no-match-text":"暫無資料",placeholder:"請選擇最高單位"},on:{change:e.lv1Change},model:{value:e.userUnit1Select,callback:function(t){e.userUnit1Select=t},expression:"userUnit1Select"}},e._l(e.unitLv1,(function(t){return a("el-option",{key:t.UntId,attrs:{value:t.UntId,label:t.UntNameFull}},[e._v(e._s(t.UntNameFull))])})),1),n[0]?a("span",{staticClass:"validateSpan"},[e._v(e._s(n[0]))]):e._e()]}}],null,!1,967362767)}),a("ValidationProvider",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.classes;return[e.userUnit1Select&&e.unitLv2.length>0?a("el-select",{staticClass:"unitSelect",class:n,attrs:{filterable:"","no-match-text":"暫無資料",placeholder:"請選擇次高單位"},on:{change:e.lv2Change},model:{value:e.userUnit2Select,callback:function(t){e.userUnit2Select=t},expression:"userUnit2Select"}},e._l(e.unitLv2,(function(t){return a("el-option",{key:t.UntId,attrs:{value:t.UntId,label:t.UntNameFull}},[e._v(e._s(t.UntNameFull))])})),1):e._e()]}}],null,!1,317675784)}),a("ValidationProvider",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.classes;return[e.userUnit2Select&&e.unitLv3.length>0?a("el-select",{staticClass:"unitSelect",class:n,attrs:{filterable:"","no-match-text":"暫無資料",placeholder:"請選擇單位"},on:{change:e.lv3Change},model:{value:e.userUnit3Select,callback:function(t){e.userUnit3Select=t},expression:"userUnit3Select"}},e._l(e.unitLv3,(function(t){return a("el-option",{key:t.UntId,attrs:{value:t.UntId,label:t.UntNameFull}},[e._v(e._s(t.UntNameFull))])})),1):e._e()]}}],null,!1,1041711922)})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("名稱")]),a("ValidationProvider",{attrs:{name:"請選擇人員名稱",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,r=t.classes;return[a("el-select",{class:r,attrs:{loading:e.userNameLoading,"loading-text":"Loading...","no-data-text":"暫無資料",filterable:"","no-match-text":"暫無資料",placeholder:"請選擇名稱"},on:{change:e.setOrg},model:{value:e.userNameSelect,callback:function(t){e.userNameSelect=t},expression:"userNameSelect"}},e._l(e.usersData,(function(e){return a("el-option",{key:e.Account,attrs:{value:e.Account,label:e.Name}})})),1),n[0]?a("span",{staticClass:"validateSpan"},[e._v(e._s(n[0]))]):e._e()]}}],null,!1,1607098778)})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("角色")]),a("ValidationProvider",{attrs:{name:"請至少選擇一種角色",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,r=t.classes;return[a("el-select",{class:r,attrs:{multiple:"",filterable:"","no-match-text":"暫無資料",placeholder:"請選擇角色"},model:{value:e.userRoleSelect,callback:function(t){e.userRoleSelect=t},expression:"userRoleSelect"}},e._l(e.rolesData,(function(t){return a("el-option",{key:t.Id,attrs:{value:t.Id,label:t.Name}},[e._v(e._s(t.Name))])})),1),n[0]?a("span",{staticClass:"validateSpan"},[e._v(e._s(n[0]))]):e._e()]}}],null,!1,309125559)})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("組織")]),a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"輸入關鍵字搜尋"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"}),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.orgsData,"show-checkbox":"","node-key":"Id","check-strictly":!0,"empty-text":"暫無資料!",indent:32,props:e.defaultProps,"filter-node-method":e.filterNode},on:{check:e.getCheckedKeys}})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle",staticStyle:{"align-self":"flex-start"}},[e._v("行事曆類別")]),e.eventTypeData?a("el-checkbox-group",{model:{value:e.eventTypeSelect,callback:function(t){e.eventTypeSelect=t},expression:"eventTypeSelect"}},e._l(e.eventTypeData,(function(t){return a("el-checkbox",{key:t.Id,attrs:{label:t.Id}},[e._v(e._s(t.EventTypeName))])})),1):e._e()],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addOrEditDialog=!1}}},[e._v("取 消")]),"新增"===e.addOrEdit?a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:e.addHandler}},[e._v("新 增")]):a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:e.editHandler}},[e._v("提 交")])],1)],1):e._e()],1)},r=[],s=a("a34a"),i=a.n(s),l=a("97d4"),o=a("1799"),c=a("a18c");function u(e,t,a,n,r,s,i){try{var l=e[s](i),o=l.value}catch(c){return void a(c)}l.done?t(o):Promise.resolve(o).then(n,r)}function d(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var s=e.apply(t,a);function i(e){u(s,n,r,i,l,"next",e)}function l(e){u(s,n,r,i,l,"throw",e)}i(void 0)}))}}var p={name:"UserUsers",components:{HeaderBox:l["a"],Pagination:o["a"]},data:function(){return{arrUnit:[],buttonList:[],userNameLoading:!1,searchLoading:!1,addLoading:!1,addOrEditDialog:!1,addOrEdit:"新增",filterText:"",totalCount:"",keyWordInput:"",currentPage:1,pageSize:"",orgsData:"",rolesData:"",usersData:"",adminUsersData:"",unitsData:"",eventTypeData:"",editUserId:"",eventTypeSelect:[],userUnit1Select:"",userUnit2Select:"",userUnit3Select:"",userNameSelect:"",userRoleSelect:"",userControlSelect:"",userIds:[],defaultProps:{children:"Children",label:"Label"}}},computed:{unitLv1:function(){var e=this;return e.unitsData.filter((function(e){return"1"===e.UntLevelb}))},unitLv2:function(){var e=this,t=e.unitsData.filter((function(t){return t.UntId===e.userUnit1Select})),a=t[0];return e.unitsData.filter((function(t){return t.UntIdUp===a.UntId&&t.UntId!==e.userUnit1Select}))},unitLv3:function(){var e=this,t=e.unitsData.filter((function(t){return t.UntId===e.userUnit2Select})),a=t[0];return e.unitsData.filter((function(t){return t.UntIdUp===a.UntId&&t.UntId!==e.userUnit2Select}))}},methods:{handleChangeUser:function(e){console.log(e.LoginName);var t=this;t.$api.GetAdminTokenAll({account:e.LoginName}).then((function(e){console.log(e);var a=e.data.token;t.$store.commit("SAVE_TOKEN",a);var n=new Date,r=new Date(n.setSeconds(n.getSeconds()+e.data.expires_in));t.$store.commit("SAVE_TOKEN_EXPIRE",r),window.localStorage.refreshtime=r,window.localStorage.expires_in=e.data.expires_in,t.GetInfoByToken(a)}))},GetInfoByToken:function(e){var t=this,a={token:e};t.$api.GetInfoByToken(a).then((function(e){window.localStorage.user=JSON.stringify(e.data.response),console.log(e.data.response),t.GetNavigationBar(e.data.response.Id)}))},GetNavigationBar:function(e){var t=this;console.log(e);var a={uid:e};t.$api.GetNavigationBar(a).then((function(e){var a=e.data.response.children;window.localStorage.router=JSON.stringify(a);var n=Object(c["b"])(a);c["a"].$addRoutes(n),t.$router.replace(t.$route.query.redirect?t.$route.query.redirect:"/").then(window.location.reload())}))},getUnits:function(){var e=this;return d(i.a.mark((function t(){var a;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.$api.GetUnits().then((function(t){e.unitsData=t.data}));case 3:case"end":return t.stop()}}),t)})))()},getRoles:function(){var e=this,t=this;t.$api.GetAllRoles().then((function(t){e.rolesData=t.data.response}))},getUsersPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPage,t=this,a={key:t.keyWordInput,page:e};t.$api.GetAdminUsers(a).then((function(a){t.adminUsersData=a.data.response.data,t.totalCount=a.data.response.dataCount,t.pageSize=a.data.response.PageSize,t.currentPage=e,t.$store.dispatch("loadingHandler",!1)}))},getAdminUsers:function(){var e,t=this;t.$api.GetAdminUsers(e).then((function(e){t.adminUsersData=e.data.response.data,t.totalCount=e.data.response.dataCount,t.currentPage=e.data.response.page,t.pageSize=e.data.response.PageSize}))},getUsers:function(e){var t=this;t.userNameLoading=!0,t.$api.GetUsers(e).then((function(e){t.usersData=e.data,t.userNameLoading=!1}))},getEventType:function(){var e=this;e.$api.GetEventType().then((function(t){e.eventTypeData=t.data}))},getOrg:function(){var e=this;e.$api.GetOrg().then((function(t){e.orgsData=t.data}))},addHandler:function(){var e=this;return d(i.a.mark((function t(){var a,n,r,s,l,o,c,u,d,p;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.$refs.obs.validate();case 3:n=t.sent,n?(a.addLoading=!0,r=a.userUnit3Select||a.userUnit2Select||a.userUnit1Select,s=a.userNameSelect,l=a.userRoleSelect,o=a.userControlSelect,c=a.eventTypeSelect,u=a.usersData.filter((function(e){return e.Account===a.userNameSelect})),d=u[0].Name,p={unitCode:r,loginName:s,roles:l,ctrlUnits:o,ctrlType:c,realName:d},a.$api.AddAdminUser(p).then((function(e){a.addOrEditDialog=!1,a.addLoading=!1,a.getUsersPage(),a.$alertM.fire({icon:"success",title:"用戶 ".concat(s," 添加成功 ! ")})}))):a.$alertM.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return t.stop()}}),t)})))()},deleteHandler:function(e){var t=this;t.$swal({title:"刪除提示",text:"確認刪除 ".concat(e.LoginName," ?"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#2f3e52",cancelButtonColor:"#522f2f",confirmButtonText:"確定",cancelButtonText:"取消"}).then((function(a){if(a.value){var n={id:e.Id};t.$api.DeleteAdminUser(n).then((function(e){t.getUsersPage()})),t.$alertT.fire({icon:"success",title:"用戶 ".concat(e.LoginName," 删除成功")})}else t.$alertT.fire({icon:"info",title:"已取消刪除"})}))},searchHandler:function(e){var t=e.page,a=e.key,n=this;n.searchLoading=!0,n.keyWordInput=a;var r={key:a,page:t};n.$api.GetAdminUsers(r).then((function(e){n.adminUsersData=e.data.response.data,n.totalCount=e.data.response.dataCount,n.currentPage=e.data.response.page,n.pageSize=e.data.response.PageSize,n.searchLoading=!1,n.currentPage=1}))},editHandler:function(){var e=this;return d(i.a.mark((function t(){var a,n,r,s,l,o,c,u,d,p,h;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.$refs.obs.validate();case 3:n=t.sent,n?(a.$store.dispatch("loadingHandler",!0),r=a.editUserId,s=a.userUnit3Select||a.userUnit2Select||a.userUnit1Select,l=a.userNameSelect,o=a.userRoleSelect,c=a.userControlSelect,u=a.eventTypeSelect,d=a.usersData.filter((function(e){return e.Account===a.userNameSelect})),p=d[0].Name,h={id:r,unitCode:s,loginName:l,roles:o,ctrlUnits:c,ctrlType:u,realName:p},a.$api.EditAdminUserById(h).then((function(e){a.$store.dispatch("loadingHandler",!1),a.addOrEditDialog=!1,a.getUsersPage(),a.$alertM.fire({icon:"success",title:"用戶".concat(l,"更新成功 ! ")})}))):a.$alertT.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return t.stop()}}),t)})))()},changeHandler:function(e){var t=this;if(0===t.userIds.length)t.$store.dispatch("loadingHandler",!1),t.$alertM.fire({icon:"error",title:"請勾選欲更新User"});else{var a;a="add"===e;var n={setMeeting:a},r=t.userIds;t.$api.PostBatchMeeting(n,r).then((function(e){t.$alertM.fire({icon:"success",title:e.data.msg}),t.getUsersPage()}))}},scrollToTop:function(){this.$refs.scrollBox.wrap.scrollTop=0},lv1Change:function(){var e=this;e.userUnit2Select="",e.userNameSelect="",e.$refs.tree.setCheckedKeys([]);var t=e.userUnit1Select,a={unitCode:t};e.getUsers(a)},lv2Change:function(){var e=this;e.userUnit3Select="",e.userNameSelect="",e.$refs.tree.setCheckedKeys([]);var t=e.userUnit2Select,a={unitCode:t};e.getUsers(a)},lv3Change:function(){var e=this;e.userNameSelect="",e.$refs.tree.setCheckedKeys([]);var t=e.userUnit3Select,a={unitCode:t};e.getUsers(a)},handleAddOrEdit:function(e){var t=arguments,a=this;return d(i.a.mark((function n(){var r,s,l;return i.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.length>1&&void 0!==t[1]?t[1]:"",s=a,!s.$refs.obs){n.next=5;break}return n.next=5,s.$refs.obs.reset();case 5:s.userUnit3Select="",s.userUnit2Select="",s.userUnit1Select="",s.userNameSelect="",s.userRoleSelect="",s.userControlSelect=[],s.eventTypeSelect=[],"add"===e?(s.addOrEdit="新增",s.addOrEditDialog=!0,s.$nextTick((function(){s.$refs.tree.setCheckedKeys([])}))):(s.$store.dispatch("loadingHandler",!0),s.editUserId=r.Id,s.addOrEditDialog=!0,s.addOrEdit="編輯",l={id:r.Id},s.$api.GetAdminUserById(l).then((function(e){var t=e.data.response;s.$nextTick((function(){s.userRoleSelect=t.Roles,s.eventTypeSelect=t.CtrlType,s.userControlSelect=t.CtrlUnits,s.$refs.tree.setCheckedKeys(s.userControlSelect),s.userNameSelect=t.LoginName;var e=s.unitsData.filter((function(e){return e.UntId===t.UnitCode})),a=e[0];s.fun(a),s.arrUnit=s.arrUnit.reverse(),1===s.arrUnit.length?(s.userUnit1Select=s.arrUnit[0],s.$api.GetUsers({unitCode:s.userUnit1Select}).then((function(e){s.usersData=e.data,s.$store.dispatch("loadingHandler",!1)}))):2===s.arrUnit.length?(s.userUnit1Select=s.arrUnit[0],s.userUnit2Select=s.arrUnit[1],s.$api.GetUsers({unitCode:s.userUnit2Select}).then((function(e){s.usersData=e.data,s.$store.dispatch("loadingHandler",!1)}))):(s.userUnit1Select=s.arrUnit[0],s.userUnit2Select=s.arrUnit[1],s.userUnit3Select=s.arrUnit[2],s.$api.GetUsers({unitCode:s.userUnit3Select}).then((function(e){s.usersData=e.data,s.$store.dispatch("loadingHandler",!1)})))}))})));case 7:case"end":return n.stop()}}),n)})))()},fun:function(e){var t=this;if(t.arrUnit.push(e.UntId),e.UntId!==e.UntIdUp){var a=t.unitsData.filter((function(t){return t.UntId==e.UntIdUp}))[0];t.fun(a)}},hasBtn:function(e){return this.buttonList.some((function(t){return t.iconCls==e}))},handleSelectionChange:function(e){var t=this,a=[];e.map((function(e){a.push(e.Id)})),t.userIds=a},filterNode:function(e,t){return!e||-1!==t.Label.indexOf(e)},getCheckedKeys:function(){this.userControlSelect=this.$refs.tree.getCheckedKeys()},setOrg:function(){var e="";e=this.userUnit3Select||this.userUnit2Select||this.userUnit1Select;var t=[];t.push(e),this.userControlSelect=t,this.$refs.tree.setCheckedKeys(t)},getButtonList:function(e,t){var a=this,n=this,r=[];return t.forEach((function(t){if(e&&t.path){var s=e.toLowerCase();if(t.path&&t.path.toLowerCase()===s)return r=t.children,void(n.buttonList=r);t.children&&a.getButtonList(s,t.children)}})),r}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){var e=this;return d(i.a.mark((function t(){var a;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.dispatch("loadingHandler",!0),a=JSON.parse(window.localStorage.router)?JSON.parse(window.localStorage.router):[],e.getButtonList(e.$route.path,a),e.getRoles(),e.getOrg(),e.getEventType(),e.getAdminUsers(),t.next=9,e.getUnits();case 9:e.$store.dispatch("loadingHandler",!1);case 10:case"end":return t.stop()}}),t)})))()}},h=p,f=a("2877"),g=Object(f["a"])(h,n,r,!1,null,null,null);t["default"]=g.exports}}]);
//# sourceMappingURL=chunk-24938be4.816fd31c.js.map