(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10161198"],{"97d4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"headerBox"}},[a("div",{staticClass:"searchBox"},[e.showDatePicker?a("el-date-picker",{staticClass:"datePicker",attrs:{type:"daterange","range-separator":"~","start-placeholder":"開始時間","end-placeholder":"結束時間"},on:{change:e.setSearchDate},model:{value:e.searchDate,callback:function(t){e.searchDate=t},expression:"searchDate"}}):e._e(),e.hasBtn("btnSearch")&&!e.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setSearchHandler(t)}},model:{value:e.keyWordInput,callback:function(t){e.keyWordInput=t},expression:"keyWordInput"}}):e._e(),e.hasBtn("btnSearch")&&e.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setSearchHandlerDate(t)}},model:{value:e.keyWordInput,callback:function(t){e.keyWordInput=t},expression:"keyWordInput"}}):e._e(),e.hasBtn("btnSearch")&&!e.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:e.searchLoading,type:"primary"},on:{click:e.setSearchHandler}},[e._v("搜尋")]):e._e(),e.hasBtn("btnSearch")&&e.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:e.searchLoading,type:"primary"},on:{click:e.setSearchHandlerDate}},[e._v("搜尋")]):e._e(),e.hasBtn("btnAdd")?a("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(t){return e.setHandleAddOrEdit("add")}}},[e._v("新增")]):e._e(),e.hasBtn("btnEdit")&&e.isEvent?a("el-button",{staticClass:"changeBtn",attrs:{type:"primary"},on:{click:e.setChangeHandler}},[e._v("批次替換")]):e._e(),e.hasBtn("btnImport")?a("el-button",{staticClass:"importBtn",attrs:{type:"primary"},on:{click:e.setImportHandler}},[e._v("匯入")]):e._e(),e.hasBtn("btnExport")?a("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:e.setExportHandler}},[e._v("匯出")]):e._e()],1)])},r=[],o=a("c1df"),s=a.n(o),i={name:"HeaderBox",data:function(){return{keyWordInput:"",changeDialogVisible:!1,importDialogVisible:!1,searchDate:""}},props:{buttonList:{type:Array,required:!0,default:[]},showDatePicker:{type:Boolean,default:!1,required:!1},searchLoading:{type:Boolean,default:!1,required:!1},isEvent:{type:Boolean,default:!1,required:!1}},methods:{hasBtn:function(e){return this.buttonList.some((function(t){return t.iconCls==e}))},setHandleAddOrEdit:function(e){this.$emit("handleAddOrEdit",e)},setChangeHandler:function(){this.$emit("changeHandler")},setSearchDate:function(){this.$emit("getSearchDate",this.searchDate)},setSearchHandler:function(){var e=this,t=1,a=e.keyWordInput;e.$emit("searchHandler",{page:t,key:a})},setExportHandler:function(){var e=this,t=e.keyWordInput;if(null!==e.searchDate&&e.searchDate){var a=s()(e.searchDate[0]).format("YYYY-MM-DD"),n=s()(e.searchDate[1]).format("YYYY-MM-DD");e.$emit("exportHandler",{key:t,startDate:a,endDate:n})}else{var r="",o="";e.$emit("exportHandler",{key:t,startDate:r,endDate:o})}},setImportHandler:function(){this.$emit("importHandler",!0)},setSearchHandlerDate:function(){var e=this,t=1,a=e.keyWordInput;if(console.log(e.searchDate),null!==e.searchDate&&e.searchDate){console.log("y");var n=s()(e.searchDate[0]).format("YYYY-MM-DD"),r=s()(e.searchDate[1]).format("YYYY-MM-DD");e.$emit("searchHandlerDate",{page:t,key:a,startDate:n,endDate:r})}else{console.log("n");var o="",i="";e.$emit("searchHandlerDate",{page:t,key:a,startDate:o,endDate:i})}}}},l=i,c=a("2877"),d=Object(c["a"])(l,n,r,!1,null,null,null);t["a"]=d.exports},9973:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[e._l(e.pList,(function(t,n){return[t>0&&t<=e.count?a("div",{key:n,staticClass:"pageD",class:{pageDonc:t==e.now},on:{click:function(a){return e.goTo(t)}}},[e._v(e._s(t))]):e._e()]})),e.now?a("select",{domProps:{value:e.now},on:{change:function(t){return e.goTo(t.target.value)}}},e._l(e.count,(function(t,n){return a("option",{key:n,domProps:{value:t}},[e._v(e._s(t+" / "+e.count))])})),0):e._e()],2)},r=[],o={props:["now","count","rightPage","leftPage"],data:function(){return{}},computed:{pList:function(){for(var e=[],t=this.now-this.leftPage;t<=this.now+this.rightPage;t++)e.push(t);return e}},methods:{goTo:function(e){this.$emit("changePage",e)}}},s=o,i=a("2877"),l=Object(i["a"])(s,n,r,!1,null,null,null);t["a"]=l.exports},a34a:function(e,t,a){e.exports=a("96cf")},dd68:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"userRoles"}},[a("HeaderBox",{attrs:{buttonList:e.buttonList,searchLoading:e.searchLoading},on:{searchHandler:e.searchHandler,handleAddOrEdit:e.handleAddOrEdit}}),a("div",{staticClass:"mainTable"},[e.rolesData?a("div",{staticClass:"tableContainer mt-5"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"tableHeader",data:e.rolesDataFilter,"empty-text":"暫無資料","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"Name",label:"角色名",sortable:""}}),a("el-table-column",{attrs:{prop:"Description",label:"說明",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark","open-delay":500,content:t.row.Description,placement:"top-end"}},[a("p",{staticClass:"textOverflow"},[e._v(e._s(t.row.Description))])])]}}],null,!1,1788459823)}),a("el-table-column",{attrs:{width:"150",prop:"CreateTime",label:"創建時間",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.CreateTime))])]}}],null,!1,2686488919)}),a("el-table-column",{attrs:{width:"100",prop:"Enabled",label:"狀態",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.Enabled?a("span",{staticClass:"status1"},[e._v("啟用")]):a("span",{staticClass:"status2"},[e._v("禁用")])]}}],null,!1,4205252612)}),a("el-table-column",{attrs:{width:"200",prop:"emit",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasBtn("btnEdit")?a("el-button",{staticClass:"outline",attrs:{size:"mini"},on:{click:function(a){return e.handleAddOrEdit("edit",t.row)}}},[e._v("編輯")]):e._e(),e.hasBtn("btnDelete")?a("el-button",{staticClass:"outline",attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteHandler(t.row)}}},[e._v("刪除")]):e._e()]}}],null,!1,705506806)})],1)],1):e._e()]),a("Page",{attrs:{now:e.currentPage,count:e.list.pageCount,rightPage:5,leftPage:5},on:{changePage:e.getRoles}}),a("el-dialog",{attrs:{"close-on-click-modal":!1,"custom-class":"addOrEditDialog",title:e.addOrEdit,visible:e.addOrEditDialog},on:{"update:visible":function(t){e.addOrEditDialog=t}}},[a("ValidationObserver",{ref:"obs"},[a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("角色名")]),a("ValidationProvider",{attrs:{name:"請輸入角色名!!",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,r=t.classes;return[a("el-input",{class:r,staticStyle:{width:"300px"},attrs:{placeholder:"請輸入角色名"},model:{value:e.roleNameInput,callback:function(t){e.roleNameInput=t},expression:"roleNameInput"}}),n[0]?a("span",{staticClass:"validateSpan"},[e._v(e._s(n[0]))]):e._e()]}}])})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("狀態")]),a("el-switch",{attrs:{"active-text":"啟用","inactive-text":"禁用","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.roleStatusSelect,callback:function(t){e.roleStatusSelect=t},expression:"roleStatusSelect"}})],1),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[e._v("說明")]),a("ValidationProvider",{attrs:{name:"請輸入角色說明!!",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,r=t.classes;return[a("el-input",{class:r,staticStyle:{width:"300px"},attrs:{placeholder:"說明欄位"},model:{value:e.roleDescription,callback:function(t){e.roleDescription=t},expression:"roleDescription"}}),n[0]?a("span",{staticClass:"validateSpan"},[e._v(e._s(n[0]))]):e._e()]}}])})],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addOrEditDialog=!1}}},[e._v("取 消")]),"新增"===e.addOrEdit?a("el-button",{attrs:{type:"primary"},on:{click:e.addHandler}},[e._v("新 增")]):a("el-button",{attrs:{type:"primary"},on:{click:e.editHandler}},[e._v("編 輯")])],1)],1)],1)},r=[],o=a("a34a"),s=a.n(o),i=a("97d4"),l=a("9973"),c=a("c1df"),d=a.n(c);function u(e,t,a,n,r,o,s){try{var i=e[o](s),l=i.value}catch(c){return void a(c)}i.done?t(l):Promise.resolve(l).then(n,r)}function p(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function s(e){u(o,n,r,s,i,"next",e)}function i(e){u(o,n,r,s,i,"throw",e)}s(void 0)}))}}var h={name:"UserRoles",components:{HeaderBox:i["a"],Page:l["a"]},data:function(){return{list:"",addOrEditDialog:!1,roleNameInput:"",roleStatusSelect:"",roleDescription:"",buttonList:[],keyWordInput:"",rolesData:"",currentPage:1,totalCount:"",pageSize:"",searchLoading:!1,addLoading:!1,editLoading:!1,addOrEdit:"新增",editId:""}},computed:{rolesDataFilter:function(){var e=this.rolesData;return e.map((function(e){e.CreateTime=d()(e.CreateTime).format("YYYY-MM-DD")})),e}},methods:{getButtonList:function(e,t){var a=this,n=this,r=[];return t.forEach((function(t){if(e&&t.path){var o=e.toLowerCase();if(t.path&&t.path.toLowerCase()===o)return r=t.children,void(n.buttonList=r);t.children&&a.getButtonList(o,t.children)}})),r},hasBtn:function(e){return this.buttonList.some((function(t){return t.iconCls==e}))},handleAddOrEdit:function(e){var t=arguments,a=this;return p(s.a.mark((function n(){var r,o;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.length>1&&void 0!==t[1]?t[1]:"",o=a,!o.$refs.obs){n.next=5;break}return n.next=5,o.$refs.obs.reset();case 5:o.roleNameInput="",o.roleDescription="",o.roleStatusSelect=!0,o.addOrEdit="新增","add"===e?o.addOrEditDialog=!0:(console.log(r),o.addOrEdit="編輯",o.addOrEditDialog=!0,o.roleNameInput=r.Name,o.roleDescription=r.Description,o.roleStatusSelect=r.Enabled,o.editId=r.Id);case 10:case"end":return n.stop()}}),n)})))()},addHandler:function(){var e=this;return p(s.a.mark((function t(){var a,n,r,o,i,l,c;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.$refs.obs.validate();case 3:n=t.sent,n?(a.addLoading=!0,r=a.roleNameInput,o=a.roleStatusSelect,i=a.roleDescription,l=d()(new Date).format("YYYY-MM-DD"),c={Name:r,Enabled:o,Description:i,CreateTime:l},a.$api.AddRole(c).then((function(e){a.getRoles(),console.log(e),a.addOrEditDialog=!1,a.addLoading=!1,a.$alertM.fire({icon:"success",title:"角色 ".concat(r," 添加成功 ! ")})}))):a.$alertM.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return t.stop()}}),t)})))()},searchHandler:function(e){var t=e.page,a=e.key,n=this;n.searchLoading=!0,n.keyWordInput=a;var r={key:a,page:t};n.$api.SearchRoles(r).then((function(e){console.log(e),n.totalCount=e.data.response.dataCount,n.pageSize=e.data.response.PageSize,n.rolesData=e.data.response,n.searchLoading=!1,n.currentPage=1}))},deleteHandler:function(e){var t=this;console.log(e),t.$swal({title:"刪除提示",text:"確認刪除角色 ".concat(e.Name," ?"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#2f3e52",cancelButtonColor:"#522f2f",confirmButtonText:"確定",cancelButtonText:"取消"}).then((function(a){if(a.value){var n={id:e.Id};t.$api.DeleteRole(n).then((function(e){t.getRoles()})),t.$alertT.fire({icon:"success",title:"角色 ".concat(e.Name," 删除成功")})}else t.$alertT.fire({icon:"info",title:"已取消刪除"})}))},editHandler:function(){var e=this;return p(s.a.mark((function t(){var a,n,r,o,i,l,c,d;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.$refs.obs.validate();case 3:n=t.sent,n?(a.editLoading=!0,r=a.editId,o=a.roleNameInput,i=a.roleStatusSelect,l=a.roleDescription,c=new Date,d={Id:r,Name:o,Enabled:i,Description:l,CreateTime:c},a.$api.EditRole(d).then((function(t){a.getRoles(),e.addOrEditDialog=!1,a.editLoading=!1,a.$alertM.fire({icon:"success",title:"角色 ".concat(o," 更新成功 ! ")})}))):a.$alertM.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return t.stop()}}),t)})))()},handleSelectionChange:function(e){this.multipleSelection=e},getRoles:function(){var e=arguments,t=this;return p(s.a.mark((function a(){var n,r,o;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,e.length>1?e[1]:void 0,r=t,o={key:r.keyWordInput,page:n},a.next=6,r.$api.GetRoles(o).then((function(e){r.totalCount=e.data.response.dataCount,r.pageSize=e.data.response.PageSize,r.rolesData=e.data.response.data,r.list=e.data.response,r.currentPage=n,r.$store.dispatch("loadingHandler",!1)}));case 6:case"end":return a.stop()}}),a)})))()}},mounted:function(){var e=this;return p(s.a.mark((function t(){var a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.dispatch("loadingHandler",!0),a=JSON.parse(window.localStorage.router)?JSON.parse(window.localStorage.router):[],e.getButtonList(e.$route.path,a),t.next=5,e.getRoles();case 5:e.$store.dispatch("loadingHandler",!1);case 6:case"end":return t.stop()}}),t)})))()}},f=h,v=a("2877"),g=Object(v["a"])(f,n,r,!1,null,null,null);t["default"]=g.exports}}]);
//# sourceMappingURL=chunk-10161198.570dda79.js.map