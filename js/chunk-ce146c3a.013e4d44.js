(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ce146c3a"],{"19b9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"certificateList"}},[a("HeaderBox",{attrs:{buttonList:t.buttonList,searchLoading:t.searchLoading},on:{searchHandler:t.searchHandler,handleAddOrEdit:t.handleAddOrEdit}}),a("div",{staticClass:"mainTable"},[t.certificateData?a("div",{staticClass:"tableContainer mt-5"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-class-name":"tableHeader",data:t.certificateData,"empty-text":"暫無資料","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"CertName",label:"證書模組名稱",sortable:""}}),a("el-table-column",{attrs:{label:"單位",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.filterId(e.row.UnitCode)&&t.filterId(e.row.UnitCode).UntNameFull?a("div",[t._v(" "+t._s(t.filterId(e.row.UnitCode).UntNameFull)+" ")]):t._e()]}}],null,!1,2954225059)}),a("el-table-column",{attrs:{width:"250",prop:"emit",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"outline",attrs:{size:"mini"},on:{click:function(a){return t.toPreveiw(e.row)}}},[t._v("預覽")]),t.hasBtn("btnEdit")?a("el-button",{staticClass:"outline",attrs:{size:"mini"},on:{click:function(a){return t.handleAddOrEdit("edit",e.row)}}},[t._v("編輯")]):t._e(),t.hasBtn("btnDelete")?a("el-button",{staticClass:"outline",attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteHandler(e.row)}}},[t._v("刪除")]):t._e()]}}],null,!1,1213131596)})],1)],1):t._e()]),a("Page",{attrs:{now:t.currentPage,count:t.list.pageCount,rightPage:5,leftPage:5},on:{changePage:t.getCertificate}}),a("el-dialog",{attrs:{"close-on-click-modal":!1,"custom-class":"addOrEditDialog",title:t.addOrEdit,visible:t.addOrEditDialog},on:{"update:visible":function(e){t.addOrEditDialog=e}}},[a("ValidationObserver",{ref:"obs"},[a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[t._v("證書模組名稱")]),a("ValidationProvider",{attrs:{name:"請輸入證書模組名稱!!",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors,r=e.classes;return[a("el-input",{class:r,staticStyle:{width:"300px"},attrs:{placeholder:"請輸入證書模組名稱"},model:{value:t.listNameInput,callback:function(e){t.listNameInput=e},expression:"listNameInput"}}),n[0]?a("span",{staticClass:"validateSpan"},[t._v(t._s(n[0]))]):t._e()]}}])})],1),a("p",{staticClass:"red"},[t._v(" 名稱規範：西元年月日單位名稱職稱姓名。例：20110201秘書室主任秘書王長龍 ")]),a("div",{staticClass:"inputBox"},[a("div",{staticClass:"inputTitle"},[t._v("單位")]),a("ValidationProvider",{attrs:{name:"請選擇單位!!",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors,r=e.classes;return[t.userControlUnit?a("el-select",{class:r,attrs:{filterable:"","no-match-text":"暫無資料",placeholder:"請選擇單位"},model:{value:t.unitSelete,callback:function(e){t.unitSelete=e},expression:"unitSelete"}},t._l(t.userControlUnit,(function(t){return a("el-option",{key:t.UntId,attrs:{label:t.UntNameFull,value:t.UntId}})})),1):t._e(),n[0]?a("span",{staticClass:"validateSpan"},[t._v(t._s(n[0]))]):t._e()]}}])})],1),a("p",{staticClass:"red"},[t._v(" 背景圖推薦尺寸為轉換成A4大小不變形之尺寸，如794px x 1122px、595px x 842px等等... ")]),a("div",{staticClass:"inputBox"},[a("p",{staticClass:"inputTitle"},[t._v("背景圖上傳")]),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.$store.state.apiBase+"Img","list-type":"text",headers:t.uploadHeader,"on-success":t.successUpload}},[a("el-tooltip",{staticClass:"item",attrs:{"open-delay":500,effect:"dark",placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 檔案格式限制:doc/docx/xls/xlsx/ppt/pttx/pdf/jpg/png "),a("br"),t._v("檔案大小限制:10MB ")]),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("選擇上傳文件")])],1)],1)],1),a("div",{staticClass:"inputBox"},[a("div",{staticClass:"inputTitle"},[t._v("已上傳文件")]),""===t.uploadUrl?a("p",{staticClass:"noFiles"},[t._v("尚未上傳文件")]):t._e(),""!==t.uploadUrl?a("div",[a("el-button",{staticClass:"downloadBtn",attrs:{size:"mini"}},[a("el-tooltip",{staticClass:"item",attrs:{"open-delay":500,effect:"dark",content:t.uploadUrl,placement:"top-start"}},[t.uploadUrl?a("p",{staticClass:"fileName"},[a("i",{staticClass:"fas fa-trash-alt",on:{"!click":function(e){return t.delFile(t.index)}}}),t._v(" "+t._s(t.uploadUrl)+" ")]):t._e()])],1)],1):t._e()])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addOrEditDialog=!1}}},[t._v("取 消")]),"新增"===t.addOrEdit?a("el-button",{attrs:{type:"primary"},on:{click:t.addHandler}},[t._v("新 增")]):a("el-button",{attrs:{type:"primary"},on:{click:t.editHandler}},[t._v("編 輯")])],1)],1)],1)},r=[],i=a("a34a"),s=a.n(i),o=a("97d4"),l=a("9973"),c=a("c1df"),d=a.n(c),u=a("cc6e");function p(t,e,a,n,r,i,s){try{var o=t[i](s),l=o.value}catch(c){return void a(c)}o.done?e(l):Promise.resolve(l).then(n,r)}function f(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var i=t.apply(e,a);function s(t){p(i,n,r,s,o,"next",t)}function o(t){p(i,n,r,s,o,"throw",t)}s(void 0)}))}}var h={name:"UserRoles",components:{HeaderBox:o["a"],Page:l["a"],Ck:u["a"]},data:function(){return{list:"",form:{FormSummary:""},unitsData:[],addOrEditDialog:!1,listNameInput:"",roleStatusSelect:"",listCk:"",buttonList:[],keyWordInput:"",certificateData:"",currentPage:1,totalCount:"",pageSize:"",searchLoading:!1,addLoading:!1,editLoading:!1,addOrEdit:"新增",editId:"",uploadHeader:{Authorization:"Bearer ".concat(window.localStorage.getItem("Token"))},uploadUrl:"",unitSelete:""}},computed:{certificateDataFilter:function(){var t=this.certificateData;return t.map((function(t){t.CreateTime=d()(t.CreateTime).format("YYYY-MM-DD")})),t},userControlUnit:function(){var t=this,e=JSON.parse(window.localStorage.getItem("user")).CtrlUnits,a=[];return e.forEach((function(e){t.unitsData.forEach((function(t){e===t.UntId&&a.push(t)}))})),a}},methods:{getUnits:function(){var t=this;t.$api.GetUnits().then((function(e){t.unitsData=e.data}))},getButtonList:function(t,e){var a=this,n=this,r=[];return e.forEach((function(e){if(t&&e.path){var i=t.toLowerCase();if(e.path&&e.path.toLowerCase()===i)return r=e.children,void(n.buttonList=r);e.children&&a.getButtonList(i,e.children)}})),r},hasBtn:function(t){return this.buttonList.some((function(e){return e.iconCls==t}))},handleAddOrEdit:function(t){var e=arguments,a=this;return f(s.a.mark((function n(){var r,i;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.length>1&&void 0!==e[1]?e[1]:"",i=a,!i.$refs.obs){n.next=5;break}return n.next=5,i.$refs.obs.reset();case 5:i.listNameInput="",i.uploadUrl="",i.unitSelete="",i.addOrEdit="新增","add"===t?i.addOrEditDialog=!0:(console.log(r),i.addOrEdit="編輯",i.addOrEditDialog=!0,i.listNameInput=r.CertName,i.unitSelete=r.UnitCode,i.editId=r.Id,i.uploadUrl=r.CertBackImg);case 10:case"end":return n.stop()}}),n)})))()},addHandler:function(){var t=this;return f(s.a.mark((function e(){var a,n,r,i,o,l;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,a.$refs.obs.validate();case 3:n=e.sent,n?(a.addLoading=!0,r=a.listNameInput,i=a.uploadUrl,o=a.unitSelete,l={CertName:r,CertBackImg:i,UnitCode:o},a.$api.PostCertificateTemp(l).then((function(t){a.getCertificate(),console.log(t),a.addOrEditDialog=!1,a.addLoading=!1,a.$alertM.fire({icon:"success",title:"模組 ".concat(name," 添加成功 ! ")})}))):a.$alertM.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return e.stop()}}),e)})))()},searchHandler:function(t){var e=t.page,a=t.key,n=this;n.searchLoading=!0,n.keyWordInput=a;var r={key:a,page:e};n.$api.GetCertificateTemp(r).then((function(t){console.log(t),n.totalCount=t.data.response.dataCount,n.pageSize=t.data.response.PageSize,n.certificateData=t.data.response.data,n.searchLoading=!1,n.currentPage=1}))},deleteHandler:function(t){var e=this;console.log(t),e.$swal({title:"刪除提示",text:"確認刪除模組 ".concat(t.CertName," ?"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#2f3e52",cancelButtonColor:"#522f2f",confirmButtonText:"確定",cancelButtonText:"取消"}).then((function(a){if(a.value){var n={id:t.Id};e.$api.DeleteCertificateTemp(n).then((function(t){e.getCertificate(),e.$alertT.fire({icon:t.data.success?"success":"error",title:"表單 ".concat(t.data.msg)})}))}else e.$alertT.fire({icon:"info",title:"已取消刪除"})}))},editHandler:function(){var t=this;return f(s.a.mark((function e(){var a,n,r,i,o,l,c;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,a.$refs.obs.validate();case 3:n=e.sent,n?(a.editLoading=!0,r=a.editId,i=a.listNameInput,o=a.uploadUrl,l=a.unitSelete,c={Id:r,CertName:i,CertBackImg:o,UnitCode:l},a.$api.PutCertificateTemp(c).then((function(e){a.getCertificate(),t.addOrEditDialog=!1,a.editLoading=!1,a.$alertM.fire({icon:"success",title:"模組 ".concat(i," 更新成功 ! ")})}))):a.$alertM.fire({icon:"error",title:"請確認欄位是否正確填寫"});case 5:case"end":return e.stop()}}),e)})))()},successUpload:function(t){var e=this;e.uploadUrl=t.response,e.$nextTick((function(){e.$refs.upload.clearFiles()}))},delFile:function(){var t=this;t.uploadUrl=""},handleSelectionChange:function(t){this.multipleSelection=t},getCertificate:function(){var t=arguments,e=this;return f(s.a.mark((function a(){var n,r,i;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:1,t.length>1?t[1]:void 0,r=e,i={key:r.keyWordInput,page:n},a.next=6,r.$api.GetCertificateTemp(i).then((function(t){r.totalCount=t.data.response.dataCount,r.pageSize=t.data.response.PageSize,r.certificateData=t.data.response.data,r.list=t.data.response,r.currentPage=n,r.$store.dispatch("loadingHandler",!1)}));case 6:case"end":return a.stop()}}),a)})))()},filterId:function(t){return this.unitsData.filter((function(e){return e.UntId==t}))[0]},toPreveiw:function(t){window.open(this.$store.state.fileBase+"Files/"+t.CertBackImg)}},mounted:function(){var t=this;return f(s.a.mark((function e(){var a;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.dispatch("loadingHandler",!0),a=JSON.parse(window.localStorage.router)?JSON.parse(window.localStorage.router):[],t.getUnits(),t.getButtonList(t.$route.path,a),e.next=6,t.getCertificate();case 6:t.$store.dispatch("loadingHandler",!1);case 7:case"end":return e.stop()}}),e)})))()}},v=h,m=a("2877"),g=Object(m["a"])(v,n,r,!1,null,null,null);e["default"]=g.exports},"97d4":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"headerBox"}},[a("div",{staticClass:"searchBox"},[t.showDatePicker?a("el-date-picker",{staticClass:"datePicker",attrs:{type:"daterange","range-separator":"~","start-placeholder":"開始時間","end-placeholder":"結束時間"},on:{change:t.setSearchDate},model:{value:t.searchDate,callback:function(e){t.searchDate=e},expression:"searchDate"}}):t._e(),t.hasBtn("btnSearch")&&!t.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setSearchHandler(e)}},model:{value:t.keyWordInput,callback:function(e){t.keyWordInput=e},expression:"keyWordInput"}}):t._e(),t.hasBtn("btnSearch")&&t.isEvent?a("el-input",{staticClass:"keyWordInput",attrs:{placeholder:"請輸入關鍵字"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setSearchHandlerDate(e)}},model:{value:t.keyWordInput,callback:function(e){t.keyWordInput=e},expression:"keyWordInput"}}):t._e(),t.hasBtn("btnSearch")&&!t.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:t.searchLoading,type:"primary"},on:{click:t.setSearchHandler}},[t._v("搜尋")]):t._e(),t.hasBtn("btnSearch")&&t.isEvent?a("el-button",{staticClass:"searchBtn",attrs:{loading:t.searchLoading,type:"primary"},on:{click:t.setSearchHandlerDate}},[t._v("搜尋")]):t._e(),t.hasBtn("btnAdd")?a("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(e){return t.setHandleAddOrEdit("add")}}},[t._v("新增")]):t._e(),t.hasBtn("btnEdit")&&t.isEvent?a("el-button",{staticClass:"changeBtn",attrs:{type:"primary"},on:{click:t.setChangeHandler}},[t._v("批次替換")]):t._e(),t.hasBtn("btnImport")?a("el-button",{staticClass:"importBtn",attrs:{type:"primary"},on:{click:t.setImportHandler}},[t._v("匯入")]):t._e(),t.hasBtn("btnExport")?a("el-button",{staticClass:"exportBtn",attrs:{type:"primary"},on:{click:t.setExportHandler}},[t._v("匯出")]):t._e()],1)])},r=[],i=a("c1df"),s=a.n(i),o={name:"HeaderBox",data:function(){return{keyWordInput:"",changeDialogVisible:!1,importDialogVisible:!1,searchDate:""}},props:{buttonList:{type:Array,required:!0,default:[]},showDatePicker:{type:Boolean,default:!1,required:!1},searchLoading:{type:Boolean,default:!1,required:!1},isEvent:{type:Boolean,default:!1,required:!1}},methods:{hasBtn:function(t){return this.buttonList.some((function(e){return e.iconCls==t}))},setHandleAddOrEdit:function(t){this.$emit("handleAddOrEdit",t)},setChangeHandler:function(){this.$emit("changeHandler")},setSearchDate:function(){this.$emit("getSearchDate",this.searchDate)},setSearchHandler:function(){var t=this,e=1,a=t.keyWordInput;t.$emit("searchHandler",{page:e,key:a})},setExportHandler:function(){var t=this,e=t.keyWordInput;if(null!==t.searchDate&&t.searchDate){var a=s()(t.searchDate[0]).format("YYYY-MM-DD"),n=s()(t.searchDate[1]).format("YYYY-MM-DD");t.$emit("exportHandler",{key:e,startDate:a,endDate:n})}else{var r="",i="";t.$emit("exportHandler",{key:e,startDate:r,endDate:i})}},setImportHandler:function(){this.$emit("importHandler",!0)},setSearchHandlerDate:function(){var t=this,e=1,a=t.keyWordInput;if(console.log(t.searchDate),null!==t.searchDate&&t.searchDate){console.log("y");var n=s()(t.searchDate[0]).format("YYYY-MM-DD"),r=s()(t.searchDate[1]).format("YYYY-MM-DD");t.$emit("searchHandlerDate",{page:e,key:a,startDate:n,endDate:r})}else{console.log("n");var i="",o="";t.$emit("searchHandlerDate",{page:e,key:a,startDate:i,endDate:o})}}}},l=o,c=a("2877"),d=Object(c["a"])(l,n,r,!1,null,null,null);e["a"]=d.exports},9973:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[t._l(t.pList,(function(e,n){return[e>0&&e<=t.count?a("div",{key:n,staticClass:"pageD",class:{pageDonc:e==t.now},on:{click:function(a){return t.goTo(e)}}},[t._v(t._s(e))]):t._e()]})),t.now?a("select",{domProps:{value:t.now},on:{change:function(e){return t.goTo(e.target.value)}}},t._l(t.count,(function(e,n){return a("option",{key:n,domProps:{value:e}},[t._v(t._s(e+" / "+t.count))])})),0):t._e()],2)},r=[],i={props:["now","count","rightPage","leftPage"],data:function(){return{}},computed:{pList:function(){for(var t=[],e=this.now-this.leftPage;e<=this.now+this.rightPage;e++)t.push(e);return t}},methods:{goTo:function(t){this.$emit("changePage",t)}}},s=i,o=a("2877"),l=Object(o["a"])(s,n,r,!1,null,null,null);e["a"]=l.exports},a34a:function(t,e,a){t.exports=a("96cf")},c297:function(t,e,a){"use strict";var n=a("e3ff"),r=a.n(n);r.a},cc6e:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{width:t.width},attrs:{id:"ckComp"}},[a("ckeditor",{attrs:{value:t.value},on:{input:t.updata}})],1)},r=[],i={name:"Ck",props:["value","width"],data:function(){return{ckContent:""}},methods:{updata:function(t){this.$emit("input",t)}}},s=i,o=(a("c297"),a("2877")),l=Object(o["a"])(s,n,r,!1,null,null,null);e["a"]=l.exports},e3ff:function(t,e,a){}}]);
//# sourceMappingURL=chunk-ce146c3a.013e4d44.js.map